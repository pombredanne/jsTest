<html>
	<head>
		<meta charset='utf-8'/>
	</head>
	<body>
		<input type="checkbox" id="box"/>
		<!-- http://www.veryhuo.com/a/view/11323.html -->
	</body>
</html>
<script>
/*
	修复jq toggle自动取消默认事件的 小bug
*/
	window.onload = function() {
	var el = document.getElementById("box");

	toggle2(el, function(e) {
		alert(e.type);
	}, function(e) {
		alert("切换到回调函数二")
	});

}
/*

var toggle2 = function(el) {

		var fns = [];
		for(var i = 0; i < arguments.length; i++) {
			if(i !== 0) {
				fns.push(arguments[i])
			}
		}
		var backup = fns.concat();
		addEvent(el, 'click', function(e) {
			if(!fns.length) {
				fns = backup.concat()
			}
			//fns[0].call(this, e);
			(fns[0])(e);
			console.log(typeof fns[0])
			console.log(fns[0])
			fns.shift();
		});
	};
*/

function addEvent(obj, type, fn) {
	if(obj.attachEvent) {
		obj['e' + type + fn] = fn;
		obj[type + fn] = function() {
			obj['e' + type + fn](window.event);
		}
		obj.attachEvent('on' + type, obj[type + fn]);
	} else obj.addEventListener(type, fn, false);
}

function removeEvent(obj, type, fn) {
	if(obj.detachEvent) {
		obj.detachEvent('on' + type, obj[type + fn]);
		obj[type + fn] = null;
	} else obj.removeEventListener(type, fn, false);
}
    window.onload = function() {
        var el = document.getElementById("box");
        toggle2(el, function(e) {
            alert(e.type)
            alert("这是回调函数一")
        }, function(e) {
            alert("切换到回调函数二")
        });
    }


    var toggle2 = function(el) {
        /*
            [].slice引用数组的slice方法 巧妙调用[]  太棒了 学习
         */
        var fns = [].slice.call(arguments, 1), backup = fns.concat();//相当于备份克隆一下

        addEvent(el, 'click', function(e) {

            if (!fns.length) { fns = backup.concat() }

            fns[0].call(this, e);

            fns.shift();

        });

    };
</script>