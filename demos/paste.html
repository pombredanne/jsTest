<!DOCTYPE html>
<html>
<head>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  <meta charset=utf-8 />
  <title>复制事件</title>
</head>
<body>
  <input type="text" id="m3ent">  
  <div contentEditable='true' id="ment">fsdfsd</div>
</body>
  <script>
  function addLoadEvent(func) {
    var oldonload = window.onload;
    if (typeof oldonload != "function") {
      window.onload = func;
    }else {
      window.onload = function() { //原理很简单 利用多次修改 onload 函数 使其最后都将其添加进去   这个原理 同样使用于 document window的其他方法 document.onmouseove
        oldonload();
        func();
      }
    }
  }

  //原生js 实现函数

/*document.getElementById('ment').onpaste=function(event,value){
    console.dir(event)
    console.log(value)
    console.log(argument)
  }

  function fn(event){
    console.log(event)
  }
  document.addEventListener('paste',fn,false);
 */

 
 // jquery 扩展paste方法

   $.fn.pasteEvents = function( delay ) {
     if (delay == undefined) delay = 20;
     return $(this).each(function() {
         var $el = $(this);
         $el.bind("paste", function(event) {
           console.log(event.clipboardData)
             //$el.trigger("prepaste");
             setTimeout(function() { $el.trigger("postpaste"); }, delay);
         });
     });
   };

  // $("#ment").on("postpaste", function(event) {
  //    // console.log(event);  //TODO  这里返回的event 跟上面原生js返回的event并不一样 因此不建议使用(至少在用到监听img的时候 不要使用) 以后使用jquery 要注意这一点啊
  // }).pasteEvents();


  // 上传图片   http://www.lzlu.com/blog/?p=810    另一种实现 暂未发现方法原理(ie下不行) --  http://imgur.com/gallery           http://nio127.blogspot.nl/2010/10/domcopy-paste-oncopy-onpaste-event.html
  // document.body.onpaste = function(e) {   //因为安全原因，浏览器为我们提供了onpaste事件，读取剪贴板数据仅能在该事件发生时在事件处理程序中进行。
  //     console.log(e)
  //     var items = e.clipboardData.items;   //TODO  clipboardData 只有在document.body上有
  //     for (var i = 0; i < items.length; ++i) {
  //         var item = e.clipboardData.items[i];
  //         if (items[i].kind == 'file' && items[i].type == 'image/png') {
  //             var fileReader = new FileReader();   //FileReader可以参考API
  //             fileReader.onloadend = function () {    //readAsDataURL是一个异步过程，这里提供回调方法
  //                 var d = this.result.substr( this.result.indexOf(',')+1);
  //                 var img = document.createElement("img");
  //                 img.src= "data:image/jpeg;base64,"+d;
  //                 document.body.appendChild(img);
  //             };
  //             fileReader.readAsDataURL(item.getAsFile());   //DataURL，不清楚了可以去看下资料
  //             break; 
  //             // Just get one
  //         }
  //     }
  // };
</script>
</html>
